<!DOCTYPE html>
{% load humanize %}
{% load jformat %}

<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            direction: rtl;
            text-align: right;
        }

        .library {
            margin-bottom: 40px;
            padding: 15px;
            border: 4px solid #ccc;
            border-radius: 10px;
            background-color: #fefefe;
        }

        .books {
            display: flex;
            overflow-x: auto;
            padding: 10px 0;
            gap: 15px;
        }

        .book {
            min-width: 250px;
            border: 2px solid #999;
            border-radius: 8px;
            padding: 10px;
            background-color: #f8f8f8;
            flex-shrink: 0;
        }

        .book h4 {
            margin: 0 0 5px 0;
            font-weight: bold;
            font-size: 18px;
        }

        .book p {
            margin: 3px 0;
            font-size: 14px;
        }

        .pagination {
            text-align: center;
            margin-top: 30px;
        }

        .pagination a {
            padding: 8px 16px;
            background-color: #007bff;
            color: white;
            text-decoration: none;
            border-radius: 8px;
            margin: 0 5px;
        }

        .pagination a:hover {
            background-color: #0056b3;
        }

        .pagination span {
            margin: 0 10px;
            font-weight: bold;
        }
    </style>
</head>
<body>

    <h1>Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡ ØªØ³Øª Ø¨Ø±Ø§ÛŒ Ø³Ù‡ÛŒÙ„ ğŸ‰</h1>

    <form method="get" action="" style="margin-bottom: 30px; text-align: center;">
        <input
            type="text"
            name="q"
            placeholder="Ù†Ø§Ù… Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡ Ø±Ø§ Ø¬Ø³ØªØ¬Ùˆ Ú©Ù†ÛŒØ¯..."
            value="{{ query }}"
            style="padding: 8px 12px; border-radius: 8px; border: 1px solid #ccc; width: 250px; font-size: 14px;"
        />
        <button
            type="submit"
            style="padding: 8px 16px; background-color: #007bff; color: white; border: none; border-radius: 8px; cursor: pointer;">
            Ø¬Ø³ØªØ¬Ùˆ ğŸ”
        </button>
    </form>

    {% if libraries %}
        {% for library in libraries %}
            <div class="library">

                <h2>
                    <a href="{% url 'library_detail' library.id %}">
                            {{ library.name }} ({{ library.location }})
                    </a>
                </h2>
                <p>ØªØ§Ø±ÛŒØ® Ø§ÛŒØ¬Ø§Ø¯: {{ library.date_of_create|jformat:"%Y/%m/%d" }}</p>
                <h3>Ú©ØªØ§Ø¨â€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø²:</h3>

                <div class="books">
                    {% for item in library.required_items.all %}
                        <div class="book">
                            <h4>{{ item.name }}</h4>
                            <p>Ø¯Ø³ØªÙ‡: {{ item.category }}</p>
                            <p>ØªØ¹Ø¯Ø§Ø¯ Ù„Ø§Ø²Ù…: {{ item.number_of_required }}</p>
                            <p>Ù…ÙˆØ¬ÙˆØ¯: {{ item.given_number }}</p>
                            <p>Ù…Ø¨Ù„Øº: {{ item.amount|intcomma }} Ø±ÛŒØ§Ù„</p>
                        </div>
                    {% empty %}
                        <p>Ù‡ÛŒÚ† Ú©ØªØ§Ø¨ÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡</p>
                    {% endfor %}
                </div>

            </div>
        {% endfor %}
    {% else %}
        <p style="text-align:center; font-weight:bold;">Ù‡ÛŒÚ† Ú©ØªØ§Ø¨ ÛŒØ§ Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡â€ŒØ§ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯</p>
    {% endif %}

    {% if libraries.has_other_pages %}
        <div class="pagination">
            {% if libraries.has_previous %}
                <a href="?page={{ libraries.previous_page_number }}{% if query %}&q={{ query }}{% endif %}">
                    Ù‚Ø¨Ù„ÛŒ
                </a>
            {% endif %}

            <span>ØµÙØ­Ù‡ {{ libraries.number }} Ø§Ø² {{ libraries.paginator.num_pages }}</span>

            {% if libraries.has_next %}
                <a href="?page={{ libraries.next_page_number }}{% if query %}&q={{ query }}{% endif %}">
                    Ø¨Ø¹Ø¯ÛŒ
                </a>
            {% endif %}
        </div>
    {% endif %}

</body>
</html>
