{% extends "base.html" %}
{% load humanize %}
{% load jformat %}

{% block title %}ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ{% endblock %}

{% block content %}

<h1 class="text-2xl font-bold text-center mb-6">Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡ ØªØ³Øª Ø¨Ø±Ø§ÛŒ Ø³Ù‡ÛŒÙ„ ğŸ‰</h1>

<!-- ÙØ±Ù… Ø¬Ø³ØªØ¬Ùˆ -->
<form method="get" action="" class="flex justify-center mb-8">
    <input
        type="text"
        name="q"
        placeholder="Ù†Ø§Ù… Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡ Ø±Ø§ Ø¬Ø³ØªØ¬Ùˆ Ú©Ù†ÛŒØ¯..."
        value="{{ query }}"
        class="p-2 rounded-lg border border-gray-300 w-60 sm:w-72 focus:outline-none focus:ring-2 focus:ring-blue-500"
    />
    <button
        type="submit"
        class="mr-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition">
        Ø¬Ø³ØªØ¬Ùˆ ğŸ”
    </button>
</form>

{% if libraries %}
    {% for library in libraries %}
        <div class="mb-10 p-4 border-2 border-gray-300 rounded-lg bg-white shadow-sm">

            <h2 class="text-xl font-semibold mb-1">
                <a href="{% url 'library_detail' library.id %}" class="hover:underline text-blue-700">
                    {{ library.name }} ({{ library.location }})
                </a>
            </h2>
            <p class="text-sm text-gray-500 mb-3">ØªØ§Ø±ÛŒØ® Ø§ÛŒØ¬Ø§Ø¯: {{ library.date_of_create|jformat:"%Y/%m/%d" }}</p>
            <h3 class="font-semibold mb-2">Ú©ØªØ§Ø¨â€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø²:</h3>

            <!-- Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ Ú©ØªØ§Ø¨ Ø¨Ø§ Ø§Ø³Ú©Ø±ÙˆÙ„ Ø§ÙÙ‚ÛŒ Ùˆ Ú©Ø§Ø±Øª ÙˆØ§Ú©Ù†Ø´â€ŒÚ¯Ø±Ø§ -->
            <div class="flex overflow-x-auto gap-2 pb-2 -mx-2 px-2 smooth-scroll">
                {% for item in library.required_items.all %}
                    <div class="flex-shrink-0
                                w-[90%] sm:w-[45%] md:w-[30%] lg:w-[22%]
                                min-w-[250px]
                                bg-gray-100 p-4 rounded-lg border border-gray-300 shadow-md">
                        <h4 class="font-bold text-lg mb-2">{{ item.name }}</h4>
                        <p class="text-sm">Ø¯Ø³ØªÙ‡: {{ item.category }}</p>
                        <p class="text-sm">ØªØ¹Ø¯Ø§Ø¯ Ù„Ø§Ø²Ù…: {{ item.number_of_required }}</p>
                        <p class="text-sm">Ù…ÙˆØ¬ÙˆØ¯: {{ item.given_number }}</p>
                        <p class="text-sm font-semibold mt-2">Ù…Ø¨Ù„Øº: {{ item.amount|intcomma }} Ø±ÛŒØ§Ù„</p>
                    </div>
                {% empty %}
                    <p>Ù‡ÛŒÚ† Ú©ØªØ§Ø¨ÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡</p>
                {% endfor %}
            </div>

        </div>
    {% endfor %}
{% else %}
    <p class="text-center font-bold text-gray-700">Ù‡ÛŒÚ† Ú©ØªØ§Ø¨ ÛŒØ§ Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡â€ŒØ§ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯</p>
{% endif %}

<!-- ØµÙØ­Ù‡â€ŒØ¨Ù†Ø¯ÛŒ -->
{% if libraries.has_other_pages %}
    <div class="flex justify-center mt-6 space-x-2">
        {% if libraries.has_previous %}
            <a href="?page={{ libraries.previous_page_number }}{% if query %}&q={{ query }}{% endif %}"
               class="px-3 py-1 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition">
                Ù‚Ø¨Ù„ÛŒ
            </a>
        {% endif %}

        <span class="px-3 py-1 font-semibold">{{ libraries.number }} / {{ libraries.paginator.num_pages }}</span>

        {% if libraries.has_next %}
            <a href="?page={{ libraries.next_page_number }}{% if query %}&q={{ query }}{% endif %}"
               class="px-3 py-1 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition">
                Ø¨Ø¹Ø¯ÛŒ
            </a>
        {% endif %}
    </div>
{% endif %}

{% endblock %}